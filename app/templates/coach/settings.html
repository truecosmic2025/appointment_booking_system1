{% extends "base.html" %}
{% block title %}Availability Settings | TrueCosmic Calendar{% endblock %}
{% block content %}
<section class="py-12">
  <div class="mx-auto max-w-3xl px-4">
    <h1 class="text-3xl font-bold text-slate-900">Availability settings</h1>
    <p class="text-slate-600 mt-1">Set your time zone and working hours. Visitors will see times in their own time zone.</p>

    <form method="post" class="mt-6 space-y-6">
      <div class="grid grid-cols-1 gap-3">
        <label class="text-sm font-medium text-slate-700">Time zone</label>
        <input name="timezone" id="timezone" value="{{ tz }}" class="rounded-md border border-slate-300 px-3 py-2" />
        <p class="text-xs text-slate-500">Tip: Your browser time zone is auto-detected below; you can copy it into this field.</p>
        <div class="text-xs text-slate-600">Detected: <span id="detectedTz">...</span></div>
      </div>

      <div>
        <div class="text-sm font-medium text-slate-700">Working days</div>
        <div class="mt-2 grid grid-cols-4 gap-2 text-sm">
          {% for d, label in [('mon','Mon'),('tue','Tue'),('wed','Wed'),('thu','Thu'),('fri','Fri'),('sat','Sat'),('sun','Sun')] %}
            <label class="inline-flex items-center gap-2"><input type="checkbox" name="day" value="{{ d }}" {% if d in selected_days %}checked{% endif %}> {{ label }}</label>
          {% endfor %}
        </div>
        <div class="mt-3 grid grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-medium text-slate-700">Start</label>
            <input type="time" name="start" value="{{ start }}" class="mt-1 rounded-md border border-slate-300 px-3 py-2" />
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700">End</label>
            <input type="time" name="end" value="{{ end }}" class="mt-1 rounded-md border border-slate-300 px-3 py-2" />
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
        <div>
          <label class="block text-sm font-medium text-slate-700">Buffer (minutes)</label>
          <input type="number" min="0" name="buffer_min" value="{{ buffer_min }}" class="mt-1 w-full rounded-md border border-slate-300 px-3 py-2" />
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700">Min notice (minutes)</label>
          <input type="number" min="0" name="min_notice_min" value="{{ min_notice_min }}" class="mt-1 w-full rounded-md border border-slate-300 px-3 py-2" />
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700">Max days ahead</label>
          <input type="number" min="1" name="max_days_ahead" value="{{ max_days_ahead }}" class="mt-1 w-full rounded-md border border-slate-300 px-3 py-2" />
        </div>
      </div>

      <div>
        <button class="rounded-md bg-slate-900 px-4 py-2 text-white font-semibold">Save settings</button>
        <a href="{{ url_for('dashboard.host') }}" class="ml-2 text-sm text-slate-700 hover:underline">Back to dashboard</a>
      </div>
    </form>
  </div>
</section>
<script>
  const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
  document.getElementById('detectedTz').textContent = tz || 'Unavailable';
</script>
{% endblock %}

